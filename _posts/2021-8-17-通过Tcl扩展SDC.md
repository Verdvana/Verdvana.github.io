---
layout: post
title:  "通过Tcl扩展SDC"
date:   2021-8-17 11:04:10 +0700
tags:
  - Tcl
---


----

## 1 前言

&#160; &#160; &#160; &#160; Synopsys设计约束（Synopsys Design Constraints，SDC）用于描述时序、功率和面积的设计要求，SDC命令基于命令工具语言（Tool Command Language，Tcl），通过使SDC扩展到Tcl，特定于工具的命令可以与原生的Tcl结构，使其成为实现工具非常强大的语言。


----


## 2 Tcl基础知识

&#160; &#160; &#160; &#160; Tcl遵循一些基本语义，每条Tcl语句以换行符或分号结束。如果一条语句跨越多行，然后在下一行继续执行，则应该在行尾加反斜杠。

&#160; &#160; &#160; &#160; 每条语句及其参数都被视为字符串，一个被双引号或大括号括住的包含多个单词的字符串认为是单个单元。

&#160; &#160; &#160; &#160; 以“#”开头的语句被认为是Tcl的注释。

```tcl
puts  "Hello, World!"; #这是注释
puts  {Hello, World!}
```

&#160; &#160; &#160; &#160; 这里的每条语句都会向标准输出设备打印“Hello, World!”。用空格分隔的单词被视为是语句中的多个参数。

&#160; &#160; &#160; &#160; Tcl中具有多种语言结构：
* 变量；
* 列表；
* 表达式与运算符；
* 控制流语句；
* 过程。

### 2.1 变量

&#160; &#160; &#160; &#160; Tcl变量是ASCII字符串，数字也用ASCII字符来表示。变量使用“set”命令来分配，例如：

```tcl
set abc "1234";  #设置变量abc的值为1234
```

&#160; &#160; &#160; &#160; 如果需要对变量求值，则需要使用美元（$）符号，例如：

```tcl
puts $abc;      #打印出1234
```

&#160; &#160; &#160; &#160; 如果索引与变量名一起使用，则可将变量视为数组。**索引不一定是整数**，它也可以是一个字符串，例如：

```tcl
set def(1) 4567;  #这里def是数组变量，索引被设置为1
set def(test) 89; #索引为test
```

&#160; &#160; &#160; &#160; 在Tcl中，“4567”和4567是相同的，因为它们都被视为字符串。要获取数组中使用的索引值，要使用命令“array names”，例如：
```tcl
array names def;  #返回值1和test
```

&#160; &#160; &#160; &#160; 要对数组变量求值，可以使用相同的原理，但要指定索引：
```tcl
puts $def(1);
puts $def(test);
```

&#160; &#160; &#160; &#160; 由于“$”在变量求值时有特殊含义，所以要打印此符号时，必须在其前面加上反斜杠。变量求值也不能放在大括号里。

&#160; &#160; &#160; &#160; 如果要尝试利用另一个命令设置变量，则应该讲命令括在方括号中。方括号中的任何内容都会在使用前求值。然而，大括号内的方括号中的内容不进行求值：
```tcl
set x [set y 100];    #将x的值设置为100
set x {[set y 100]};  #将x的值设置为[set y 100]
```

### 4.2 列表

&#160; &#160; &#160; &#160; Tcl中的列表是对象的集合。能够对列表进行添加、索引、搜索等操作：
```tcl
#创建列表
set gates [list AND OR NOT NAND NOR]
set getes {{AND} {OR} {NOT} {NAND} {NOR}}
set gates [split "AND.OR.NOT.NAND.NOR" "."]
#将另一个项目添加到列表中，使用lappend
set gates [lappend gates XOR]
#要在列表中搜索，使用lsearch，它将返回列表中匹配的索引
puts [lsearch $gates NOT]   #返回2
puts [lsearch $gates XNOR]  #返回-1，因为找不到
```

### 4.3 表达式与运算符

&#160; &#160; &#160; &#160; Tcl中使用expr命令来对表达式求值：
```tcl

----
&#160; &#160; &#160; &#160; 告辞。