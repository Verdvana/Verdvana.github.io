---
layout: post
title:  "Perl常用代码片段汇总"
date:   2021-8-30 20:59:10 +0700
tags:
  - Perl
---


----

## 1 前言

&#160; &#160; &#160; &#160; 最近写脚本上瘾，毕竟太懒了，懒得看那么多report。积累了一些常用的代码片段，懒得每次再写了，搁在这随时复制。🤷‍♂️


----


## 2 chomp

&#160; &#160; &#160; &#160; 这玩意的用处是删除末尾的换行符，常跟标准输入句柄一起用，删掉输入完成时的那个回车：

```perl
chomp($Moudle_Name = <STDIN>);
```

&#160; &#160; &#160; &#160; 一个长得很像的chop函数，用来去掉变量最后一个字符。

-----

## 3 获取时间

&#160; &#160; &#160; &#160; 获取本地时区时间并格式化：

```perl
my ($sec ,$min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = localtime(time);
$mon=(sprintf "%02d", ($mon+1));    # 0-11，因此要+1
$mday=(sprintf "%02d", $mday);
$year=$year+1900;                   # 从1900年算起，因此要+1900
```

&#160; &#160; &#160; &#160; 也可以获取格林尼治时间：

```perl
my ($sec ,$min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = gmtime(time);
$mon=(sprintf "%02d", ($mon+1));    # 0-11，因此要+1
$mday=(sprintf "%02d", $mday);
$year=$year+1900;                   # 从1900年算起，因此要+1900
```

&#160; &#160; &#160; &#160; 这其中可以使用POSIX函数格式化：

```perl
use POSIX qw(strftime);
$time = strftime "%y%m%d",localtime;
```

----

## 4 获取路径

&#160; &#160; &#160; &#160; 获取当前路径：
```perl
use Cwd;
my $dir = getcwd;
```

&#160; &#160; &#160; &#160; 或者：
```perl
my $dir = $ENV{'PWD'};
```
----

## 5 路径、文件搜索

&#160; &#160; &#160; &#160; 在当前路径下，级数可调的路径、文件搜索：

```perl
my $path        = "./*";
my $series_subf = 3;

sub scan_file{
  my @files = glob{$_[0]};
  foreach(@files){
    my $series_subf = $_[1] - 1;
    if(-d $_){
      print "path: $_ \n";

      if($series_subf > 0){
        my $path = $_."/*";
        scan_file($path, $series_subf);
      }
    }
    elsif(-f $_){
      print "file: $_ \n";
    }
  }
}

scan_file($path, $series_subf);
```

----

## 6 文件处理（打开、新建、删除、寻找）

### 6.1 打开

&#160; &#160; &#160; &#160; 打开文件并逐行读取：

```perl
open(PREPROCESSED_FILE, "PREPROCESSED_FILE.sv") || die "Cannot open HDL file\n";
while(<PREPROCESSED_FILE>){
  ……
}
close PREPROCESSED_FILE;
```

### 6.2 新建

&#160; &#160; &#160; &#160; 新建文件并写入字符：

```perl
open TB_FILE, '>'."$TB_Name.sv";
print TB_FILE $Parameter;
close HDL_FILE;
```

### 6.3 删除文件


&#160; &#160; &#160; &#160; 删除文件：

```perl
unlink "$TB_Name.sv";
```

## 7 变量匹配

&#160; &#160; &#160; &#160; 在使用变量匹配时，容易遇到变量内有需要转义的字符的情况，可以用“\Q...\E”进行全部转义：

```perl
$x =~ /\Q$y\E/;
```





----
&#160; &#160; &#160; &#160; 告辞。