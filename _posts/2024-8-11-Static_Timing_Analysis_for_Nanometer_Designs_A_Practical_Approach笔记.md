---
layout: post
title:  "《Static Timing Analysis for Nanometer Designs：A Practical Approach》笔记"
date:   2024-8-11 9:37:10 +0700
tags:
  - STA
---

-------

## 1 前言

&#160; &#160; &#160; &#160; 

----

## 2 基础概念

### 2.1 CMOS

### 2.2 电平翻转

### 2.3 传播延迟（Propagation Delay）

&#160; &#160; &#160; &#160; 通过设置输入/输出的上升/下降沿的阈值点来计算传播延迟。比如用以下四个变量来定义的点：
```tcl
input_threshold_pct_fall  :50.0;  #输入下降沿阈值点 A
input_threshold_pct_rise  :50.0;  #输入上升沿阈值点 B
output_threshold_pct_fall :50.0;  #输出下降沿阈值点 C
output_threshold_pct_rise :50.0;  #输出上升沿阈值点 D
```

&#160; &#160; &#160; &#160; 下图表明传播延迟是如何根据这四个点计算的：

![img1][img1]

### 2.4 转换率（Slew Rate）与转换时间（Transition Time）

&#160; &#160; &#160; &#160; 转换率和转换时间互为倒数。

&#160; &#160; &#160; &#160; 转换率通过以下四个上升/下降沿的阈值来计算：

```tcl
slew_lower_threshold_pct_fall  :30.0;  #下降沿阈值低点 A
slew_upper_threshold_pct_fall  :70.0;  #下降沿阈值高点 B
slew_lower_threshold_pct_rise  :30.0;  #上升沿阈值低点 C
slew_upper_threshold_pct_rise  :70.0;  #上升沿阈值高点 D
```

&#160; &#160; &#160; &#160; 下图表明转换时间根据这四个点的计算：

![img2][img2]

### 2.4 偏移（Skew）、抖动（Jitter）与不确定性（Uncertainty）

&#160; &#160; &#160; &#160; 偏移是指2个或多个信号（data或clock）之间的时序之差的最大值。

&#160; &#160; &#160; &#160; 抖动是指信号在两个不同周期之间存在的差值。时钟抖动实在时钟发生器内部产生的，和晶振或PLL内部电路有关。

&#160; &#160; &#160; &#160; Uncertainty = Skew + Jitter + Margin。

### 2.5 时序弧（Timing Arc）

&#160; &#160; &#160; &#160; 分类：

* 单元弧（Cell Arc），每个单元都有多个时序弧
  * 组合逻辑单元：单元每个输入到每个输出都有时序弧
  * 时序逻辑单元：
    * 时钟输入引脚到输出引脚，例如CK到Q，为时序单元内部路径的传输延迟（Delay Arc）
    * 时钟输入引脚到其他引脚，例如CK到D，用于setup、hold分析（Timing Check Arc）
* 线弧（Net Arc）
  * 一个单元的输出到下一个单元的输入之间的路径，引起传输延迟


&#160; &#160; &#160; &#160; 每个时序弧都有时序极性（Timing Sense）：
* 正单调（Positive Unate）：输入的极性变化导致输出极性的变化相同或不变，例如与门，或门
* 负单调（Negative Unate）：输入的极性变化导致输出极性的变化相反或不变，例如与非门，或非门
* 非单调（Non Unate）：输入的极性变化决定不了输出极性变化，也要取决于其它输入状态，例如异或门


### 2.6 最大和最小时序路径

&#160; &#160; &#160; &#160; 逻辑通过几条不同的路径传播到终点，每条路径的传播时间被称为路径延迟（Path Delay），这包括该路径上cell和net的总延迟。延迟最大的叫最大路径（Max Path/Late Path），延迟最小的路径叫最小路径（Min Path/Early Path）。

### 2.7 时钟域（Clock Domain）

&#160; &#160; &#160; &#160; 由同一个时钟驱动的触发器所在的区域为一个时钟域。

&#160; &#160; &#160; &#160; 如果两个时钟域之间没有数据路径，则这两个时钟域相互独立。相反如果有数据路径跨时钟域，则必须确定这条路径是真还是假。

&#160; &#160; &#160; &#160; 例如，一个两倍频时钟驱动的触发器发起数据，再由一倍频时钟驱动的触发器捕获数据，就是真实路径（real path）。如果设计人员将时钟同步器明确放置在两个时钟域之间，即使好像存在从一个时钟域到另一个时钟域的时序路径，但数据没有被约束要在一个时钟周期内通过同步器传播，因此这样的路径被称为伪路径（false path），因为是由时钟同步器来确保数据正确地跨时钟域传播。可以使用set_false_path命令指定时钟域之间的伪路径。**分辨出哪些跨时钟域路径是真实的，哪些是伪路径，是时序验证工作的重要组成部分，这使得设计人员可以专注于验证真实的时序路径。**

&#160; &#160; &#160; &#160; 还有一种伪路径的例子。比如通过二选一MUX选择时钟源，虽然只有一个时钟域，却有两个时钟，而这两个时钟是互斥的，因为一次只有一个时钟处于有效状态，因此这两个时钟之间不存在时序路径。

### 2.8 工作条件


&#160; &#160; &#160; &#160; 工作条件定义为工艺（Process）、电压（Voltage）和温度（Temperature）的组合，简称PVT。逻辑单元的延迟和互连走线的延迟是根据特定的PVT计算的。

----

## 3 标准单元库

&#160; &#160; &#160; &#160; 标准单元库包含时序信息、单元面积、功能等信息。














&#160; &#160; &#160; &#160; **起点（start point）**：输入端口；触发器或寄存器的时钟引脚。
&#160; &#160; &#160; &#160; **终点（end point）**：输出端口；时序器件除时钟引脚以外的所有输入引脚。

&#160; &#160; &#160; &#160; **发送沿**：

&#160; &#160; &#160; &#160; **捕获沿**：

&#160; &#160; &#160; &#160; **建立时间（setup）**：在时钟有效沿到达之前，数据必须保持稳定的最小时间，简称Tsu。

&#160; &#160; &#160; &#160; **保持时间（hold time）**：在时钟有效沿到达之后，数据必须保持稳定的最小时间，简称Th。





----

[img1]:
[img2]:
[img3]:
[img4]:
[img5]: